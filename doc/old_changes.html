<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Pexpect - a Pure Python Expect-like module</title>
<link rel="stylesheet" href="clean.css" type="text/css">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="Author" content="Noah Spurrier">
<meta name="Keywords"
 content="pexpect, Noah Spurrier, pypect, Python, Libes, TCL, Expect, pipe, popen, pyExpect, expectpy, expect-like, expect-alike, expect like">
<meta name="Description"
 content="Pexpect is a pure Python Expect-like module. Pexpect makes Python a better tool for controlling other applications.">
</head>
<body bgcolor="#ffffff" text="#000000">

<div id="Content">
<hr noshade="noshade" size="1">
<h1><a name="changes"></a>CHANGES</h1>
<h2>Current Release</h2>
<p>Fixed OSError exception when a pexpect object is cleaned up.
Previously you might have seen this exception:</p>
<blockquote>
  <pre class="code">Exception exceptions.OSError: (10, 'No child processes') <br>in &lt;bound method spawn.__del__ of<br>&lt;pexpect.spawn instance at 0xd248c&gt;&gt; ignored</pre>
</blockquote>
<p>You should not see that anymore. Thanks to Michael Surette.</p>
<p>Added support for buffering reads. This greatly improves speed when
trying to match long output from a child process. When you create an
instance of the spawn object you can then set a buffer size. For now
you MUST do the following to turn on buffering -- it may be on by
default in future version.</p>
<blockquote>
  <pre class="code">child = pexpect.spawn ('my_command')<br>child.maxread=1000 # Sets buffer to 1000 characters.</pre>
</blockquote>
<div>
<p>I made a subtle change to the way TIMEOUT and EOF exceptions behave.
Previously you could either expect these states in which case pexpect
will not raise an exception, or you could just let pexpect raise an
exception when these states were encountered. If you expected the
states then the 'before' property was set to everything before the
state was encountered, but if you let pexpect raise the exception then
'before' was not set. Now the 'before' property will get set either way
you choose to handle these states.</p>
<h2><i>Older changes...</i></h2>
<p>The spawn object now provides iterators for a <i>file-like interface</i>.
This makes Pexpect a more complete file-like object. You can now write
code like this:</p>
<blockquote>
  <pre class="code">child = pexpect.spawn ('ls -l')<br>for line in child:<br>    print line<br></pre>
</blockquote>
<p>I added the attribute <span class="code">exitstatus</span>. This
will give the exit code returned by the child process. This will be set
to <span class="code">None</span> while the child is still alive. When
<span class="code">isalive()</span> returns 0 then <span class="code">exitstatus</span>
will be set.</p>
<p>I made a few more tweaks to <span class="code">isalive()</span> so
that it will operate more consistently on different platforms. Solaris
is the most difficult to support.</p>
<p>&nbsp;</p>
<p>You can now put <span class="code">TIMEOUT</span> in a list of
expected patterns. This is just like putting <span class="code">EOF</span>
in the pattern list. Expecting for a <span class="code">TIMEOUT</span>
may not be used as often as <span class="code">EOF</span>, but this
makes Pexpect more consitent.</p>
<p>Thanks to a suggestion and sample code from Chad J. Schroeder I
added the ability for Pexpect to operate on a file descriptor that is
already open. This means that Pexpect can be used to control streams
such as those from serial port devices. Now you just pass the integer
file descriptor as the "command" when contsructing a spawn open. For
example on a Linux box with a modem on ttyS1:</p>
<blockquote>
  <pre class="code">fd = os.open("/dev/ttyS1", os.O_RDWR|os.O_NONBLOCK|os.O_NOCTTY)<br>m = pexpect.spawn(fd) # Note integer fd is used instead of usual string.<br>m.send("+++") # Escape sequence<br>m.send("ATZ0\r") # Reset modem to profile 0<br>rval = m.expect(["OK", "ERROR"])</pre>
</blockquote>
<h3>Pexpect now tests itself on Compile Farm!</h3>
<p>I wrote a nice script that uses ssh to connect to each machine on
Source Forge's Compile Farm and then run the testall.py script for each
platform. The result of the test is then recorded for each platform.
Now it's easy to run regression tests across multiple platforms.</p>
<h3>Pexpect is a file-like object</h3>
<p>The spawn object now provides a <i>file-like interface</i>. It
supports most of the methods and attributes defined for Python File
Objects. </p>
<p>I changed write and writelines() so that they no longer return a
value. Use send() if you need that functionality. I did this to make
the Spawn object more closely match a file-like object.</p>
<p>read() was renamed to read_nonblocking(). I added a new read()
method that matches file-like object interface. In general, you should
not notice the difference except that read() no longer allows you to
directly set the timeout value. I hope this will not effect any
existing code. Switching to read_nonblocking() should fix existing code.</p>
<p>I changed the name of <span class="code">set_echo()</span> to <span
 class="code">setecho()</span>.</p>
<p>I changed the name of <span class="code">send_eof()</span> to <span
 class="code">sendeof()</span>.</p>
<p>I modified <span class="code">kill()</span> so that it checks to
make sure the pid isalive().</p>
<p>I modified <span class="code">spawn()</span> (really called from <span
 class="code">__spawn()</span>)so that it does not raise an expection
if <span class="code">setwinsize()</span> fails. Some platforms such
as Cygwin do not like setwinsize. This was a constant problem and since
it is not a critical feature I decided to just silence the error.
Normally I don't like to do that, but in this case I'm making an
exception.</p>
<p>Added a method <span class="code">close()</span> that does what you
think. It closes the file descriptor of the child application. It makes
no attempt to actually kill the child or wait for its status. </p>
<p>Add variables <span class="code">__version__</span> and <span
 class="code">__revision__</span> (from cvs) to the pexpect modules.
This is mainly helpful to me so that I can make sure that I'm testing
with the right version instead of one already installed.</p>
<h3>Logging changes</h3>
<blockquote>
  <p><span class="code">log_open()</span> and <span class="code">log_close()</span>
have been removed. Now use <span class="code">setlog()</span>. The <span
 class="code">setlog()</span> method takes a file object. This is far
more flexible than the previous log method. Each time data is written
to the file object it will be flushed. To turn logging off simply call <span
 class="code">setlog()</span> with None.</p>
</blockquote>
<h2>isalive changes</h2>
<blockquote>
  <p>I renamed the <span class="code">isAlive()</span> method to <span
 class="code">isalive()</span> to match the more typical naming style
in Python. Also the technique used to detect child process status has
been drastically modified. Previously I did some funky stuff with
signals which caused indigestion in other Python modules on some
platforms. It's was a big headache. It still is, but I think it works
better now.</p>
</blockquote>
<h3>attribute name changes</h3>
<blockquote>
  <p>The names of some attributes have been changed. This effects the
names of the attributes that are set after called the <span
 class="code">expect()</span> method.</p>
  <table class="pymenu" border="0" cellpadding="5">
    <tbody>
      <tr>
        <th class="pymenu">NEW NAME</th>
        <th class="pymenu">OLD NAME</th>
      </tr>
      <tr>
        <td><span class="code">before</span><br>
        <i>Everything before the match.</i></td>
        <td><span class="code">before</span></td>
      </tr>
      <tr>
        <td><span class="code">after</span><br>
        <i>Everything after and including the first character of the
match</i></td>
        <td><span class="code">matched</span></td>
      </tr>
      <tr>
        <td><span class="code">match</span><br>
        <i>This is the re MatchObject from the match.<br>
You can get groups() from this.<br>
See '<span class="code">uptime.py</span>' in the examples tar ball.</i></td>
        <td><i>New -- Did not exist</i></td>
      </tr>
    </tbody>
  </table>
</blockquote>
<h3>EOF changes</h3>
<blockquote>
  <p>The <span class="code">expect_eof()</span> method is gone. You
can now simply use the <span class="code">expect()</span> method to
look for EOF.</p>
  <p>Was:</p>
  <blockquote>
    <p><span class="code">p.expect_eof ()</span></p>
  </blockquote>
  <p>Now:</p>
  <blockquote>
    <p><span class="code">p.expect (pexpect.EOF)</span></p>
  </blockquote>
</blockquote>
<hr noshade="noshade" size="1">
<h1><a name="testing"></a>TESTING</h1>
<p>The following platforms have been tested:</p>
<!--
<table class="pymenu" border="0" cellpadding="5">
  <tbody>
    <tr>
      <th class="pymenu">PLATFORM</th>
      <th class="pymenu">RESULTS</th>
    </tr>
    <tr>
      <td>Linux 2.4.9-ac10-rmk2-np1-cerf2<br>
armv4l</td>
      <td><b><i>all tests passed</i></b></td>
    </tr>
    <tr>
      <td>Linux 2.4.18 #2<br>
sparc64</td>
      <td><b><i>all tests passed</i></b></td>
    </tr>
    <tr>
      <td>MacOS X Darwin Kernel Version 5.5<br>
powerpc</td>
      <td>
      <p>failed more than one test.</p>
      <p>Generally Pexpect works on OS X, but the nature of the quirks
cause a many of the tests to fail. See <a href="#bugs">bugs</a>
(Incomplete Child Output). The problem is more than minor, but Pexpect
is still more than useful for most tasks. The problem is an edge case.</p>
      </td>
    </tr>
    <tr>
      <td>Linux 2.2.20<br>
alpha<br>
      </td>
      <td><b><i>all tests passed</i></b></td>
    </tr>
    <tr>
      <td>Linux 2.4.18-5smp<br>
i686</td>
      <td><b><i>all tests passed</i></b></td>
    </tr>
    <tr>
      <td>OpenBSD 2.9 GENERIC#653<br>
i386</td>
      <td><b><i>all tests passed</i></b></td>
    </tr>
    <tr>
      <td>Solaris</td>
      <td>
      <p>failed <span class="code">test_destructor</span></p>
      <p>Otherwise, this is working pretty well. The destructor problem
is minor. For some reason, the <i>second</i> time a pty file
descriptor is created and deleted it never gets returned for use. It
does not effect the first time or the third time or any time after
that. It's only the second time. This is weird... This could be a file
descriptor leak, or it could be some peculiarity of how Solaris
recycles them. I thought it was a UNIX requirement for the OS to give
you the lowest available filedescriptor number. In any case, this
should not be a problem unless you create hundreds of pexpect
instances... It may also be a pty module bug. </p>
      </td>
    </tr>
    <tr>
      <td>Windows XP Cygwin</td>
      <td>failed <span class="code">test_destructor</span>. That it
works at all is amazing to me. Cygwin rules!</td>
    </tr>
  </tbody>
</table>
-->
<h1>&nbsp;</h1>
<h1><a name="todo">TO DO</a></h1>
<p>Add an option to add a delay after each expect() or before each
read()/readline() call to automatically avoid the <a href="#echo_bug">echo
bug</a>.</p>
<p>&nbsp;</p>
</div>
<hr noshade="noshade" size="1">
<table border="0">
  <tbody>
    <tr>
      <td> <a href="http://www.noah.org/email/"><img src="email.png"
 alt="Click to send email." border="0" height="16" width="100"></a> </td>
    </tr>
  </tbody>
</table>
</div>
<div id="Menu"><b>INDEX</b><br>
<hr noshade="noshade" size="1"> <a href="#license"
 title="Python Software Foundation License">License</a><br>
<a href="#download" title="Download and setup instructions">Download</a><br>
<a href="#doc" title="Documentation and overview">Documentation</a><br>
<a href="#status" title="Project Status">Project Status</a><br>
<a href="#requirements" title="System requirements to use Pexpect">Requirements</a><br>
<a href="#overview" title="Overview of what Pexpect does">Overview</a><br>
<a href="#faq" title="FAQ">FAQ</a><br>
<a href="#bugs" title="Bugs and work-arounds">Known Bugs</a><br>
<a href="#changes" title="What's new with Pexpect">Recent Changes</a><br>
<a href="#testing" title="Test results on various platforms">Testing</a><br>
<a href="#todo" title="What to do next">To do</a><br>
<a href="http://pexpect.svn.sourceforge.net/viewvc/pexpect/trunk/pexpect/" title="browse SVN">Browse SVN</a><br>
<br>
<a href="http://sourceforge.net/projects/pexpect/"
 title="The Pexpect project page on SourceForge.net"> <img
 src="http://sourceforge.net/sflogo.php?group_id=59762&amp;type=5"
 alt="The Pexpect project page on SourceForge.net" border="0"
 height="31" width="105"> </a> </div>
</body>
</html>